{
  "generated_at_epoch_ms": 1771567825508,
  "summary": {
    "total": 20,
    "passed": 19,
    "failed": 1,
    "pass_rate": 95.0,
    "by_suite": {
      "intelligence": {
        "total": 8,
        "passed": 8,
        "failed": 0
      },
      "scam_detector": {
        "total": 5,
        "passed": 5,
        "failed": 0
      },
      "route": {
        "total": 6,
        "passed": 6,
        "failed": 0
      },
      "live_endpoint": {
        "total": 1,
        "passed": 0,
        "failed": 1
      }
    }
  },
  "results": [
    {
      "suite": "intelligence",
      "name": "phone_hyphen_preserved",
      "passed": true,
      "details": {
        "input": "Call me at +91-9876543210 now.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [
            "+91-9876543210"
          ],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "phone_space_normalized",
      "passed": true,
      "details": {
        "input": "Call me at +91 8765432109 now.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [
            "+91-8765432109"
          ],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "upi_fakebank_detected",
      "passed": true,
      "details": {
        "input": "Transfer to scammer.fraud@fakebank for verification.",
        "output": {
          "bankAccounts": [],
          "upiIds": [
            "scammer.fraud@fakebank"
          ],
          "phishingLinks": [],
          "phoneNumbers": [],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": [
            "transfer"
          ]
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "email_not_upi_fragment",
      "passed": true,
      "details": {
        "input": "Contact offers@fake-amazon-deals.com for support.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [],
          "emailAddresses": [
            "offers@fake-amazon-deals.com"
          ],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "bank_account_detected",
      "passed": true,
      "details": {
        "input": "Account number 1234567890123456 needs verification.",
        "output": {
          "bankAccounts": [
            "1234567890123456"
          ],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "phone_not_bank_account",
      "passed": true,
      "details": {
        "input": "Call 9876543210 immediately.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [
            "+91-9876543210"
          ],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": [
            "immediate"
          ]
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "url_trailing_punctuation_trimmed",
      "passed": true,
      "details": {
        "input": "Click http://amaz0n-deals.fake-site.com/claim?id=12345.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [
            "http://amaz0n-deals.fake-site.com/claim?id=12345"
          ],
          "phoneNumbers": [],
          "emailAddresses": [],
          "caseIds": [],
          "policyNumbers": [],
          "orderNumbers": [],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "intelligence",
      "name": "case_policy_order_extraction",
      "passed": true,
      "details": {
        "input": "Case REF-2026-001, policy POL-778899, order ORD-556677.",
        "output": {
          "bankAccounts": [],
          "upiIds": [],
          "phishingLinks": [],
          "phoneNumbers": [],
          "emailAddresses": [],
          "caseIds": [
            "REF-2026",
            "POL-778899",
            "ORD-556677"
          ],
          "policyNumbers": [
            "POL-778899"
          ],
          "orderNumbers": [
            "ORD-556677"
          ],
          "suspiciousKeywords": []
        }
      }
    },
    {
      "suite": "scam_detector",
      "name": "legit_domain_detected",
      "passed": true,
      "details": {
        "input": "https://www.amazon.in/help",
        "is_legit": true,
        "urls": [
          "www.amazon.in"
        ]
      }
    },
    {
      "suite": "scam_detector",
      "name": "domain_spoofing_not_whitelisted",
      "passed": true,
      "details": {
        "input": "https://amazon.in.verify-now.ru/login",
        "is_legit": false,
        "urls": [
          "amazon.in.verify-now.ru"
        ]
      }
    },
    {
      "suite": "scam_detector",
      "name": "otp_phrase_not_blindly_legit",
      "passed": true,
      "details": {
        "input": "Your OTP is 456789. Share now to unblock account.",
        "automated_detected": false
      }
    },
    {
      "suite": "scam_detector",
      "name": "strong_scam_indicators_detected",
      "passed": true,
      "details": {
        "input": "Your account will be blocked today. Share your OTP immediately.",
        "patterns": [
          "account (will be )?(blocked|suspended|closed) today",
          "share (your )?(otp|pin|password)"
        ]
      }
    },
    {
      "suite": "scam_detector",
      "name": "analyze_quick_flags_obvious_scam",
      "passed": true,
      "details": {
        "output": {
          "is_scam": true,
          "confidence": 0.85,
          "detected_patterns": [
            "share (your )?(otp|pin|password)"
          ],
          "reasoning": "Quick scan: scam patterns detected"
        }
      }
    },
    {
      "suite": "route",
      "name": "spec_shape_on_valid_request",
      "passed": true,
      "details": {
        "status_code": 200,
        "elapsed_ms": 43.18,
        "keys": [
          "status",
          "reply",
          "sessionId",
          "scamDetected",
          "scamType",
          "confidenceLevel",
          "extractedIntelligence",
          "totalMessagesExchanged",
          "engagementDurationSeconds",
          "engagementMetrics",
          "agentNotes"
        ]
      }
    },
    {
      "suite": "route",
      "name": "callback_triggered_on_scam_turn_3_plus",
      "passed": true,
      "details": {
        "status_code": 200,
        "callback_calls": 1,
        "scamDetected": true
      }
    },
    {
      "suite": "route",
      "name": "callback_not_triggered_for_legit",
      "passed": true,
      "details": {
        "status_code": 200,
        "callback_calls_before": 1,
        "callback_calls_after": 1,
        "scamDetected": false
      }
    },
    {
      "suite": "route",
      "name": "invalid_api_key_rejected",
      "passed": true,
      "details": {
        "status_code": 401,
        "body": "{\"detail\":\"Invalid API Key\"}"
      }
    },
    {
      "suite": "route",
      "name": "missing_api_key_behavior",
      "passed": true,
      "details": {
        "status_code": 422,
        "body": "{\"detail\":[{\"type\":\"missing\",\"loc\":[\"header\",\"x-api-key\"],\"msg\":\"Field required\",\"input\":null}]}"
      }
    },
    {
      "suite": "route",
      "name": "malformed_json_fallback_response",
      "passed": true,
      "details": {
        "status_code": 200,
        "keys": [
          "status",
          "reply",
          "sessionId",
          "scamDetected",
          "scamType",
          "confidenceLevel",
          "extractedIntelligence",
          "totalMessagesExchanged",
          "engagementDurationSeconds",
          "engagementMetrics",
          "agentNotes"
        ]
      }
    },
    {
      "suite": "live_endpoint",
      "name": "health_reachable",
      "passed": false,
      "details": {
        "error": "ConnectionError: HTTPSConnectionPool(host='guvi-honeypot-07tp.onrender.com', port=443): Max retries exceeded with url: /health (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x000001DCAFB00050>: Failed to establish a new connection: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions'))"
      }
    }
  ]
}